 -----
 SIRH-EAE-WS
 -----
 Nicolas RAYNAUD
 -----
  03/10/2012
  
Procédures

* Installation de Tomcat, base de données AS400, base de données Oracle

** Récupération du driver jt400

	Il suffit de suivre la démarche suivante depuis un shell linux :
	
+------------------------------------------+
cd
mkdir jt400;
export JT400_version="6.7";
cd jt400;
wget -U NoSuchBrowser/1.0 http://repo1.maven.org/maven2/net/sf/jt400/jt400/$JT400_version/jt400-$JT400_version.jar
+------------------------------------------+	

** Installation du driver jt400

	Sous linux :
	
+------------------------------------------+
export CATALINA_HOME=/apache-tomcat-7.0.27/
cp $HOME/jt400/jt400-$JT400_version.jar $CATALINA_HOME/lib
+------------------------------------------+

	A ce stade, le driver est bien déposé.

** Récupération du driver ojdbc6

	Il suffit de suivre la démarche suivante depuis un shell linux :
	
+------------------------------------------+
-
+------------------------------------------+	

** Installation du driver ojdbc6

	Sous linux :
	
+------------------------------------------+
export CATALINA_HOME=/apache-tomcat-7.0.27/
cp /path/to/jar/ojdbc6.jar $CATALINA_HOME/lib
+------------------------------------------+

	A ce stade, le driver est bien déposé.
	
** Ajout des datasources

    Dans tomcat, il est possible de declarer des datasources au niveau du serveur et d'utiliser ceux-ci dans votre application
	
	* Se positionner dans le répertoire CONF de tomcat 
	
	* Editer le fichier context.xml et ajouter le contenu suivant à l'interieur de la balise <Context> :
	
+------------------------------------------+
<Resource name="jdbc/SIRH" auth="Container" type="javax.sql.DataSource"
	factory="org.apache.tomcat.dbcp.dbcp.BasicDataSourceFactory"
	testWhileIdle="true" testOnBorrow="true" testOnReturn="false"
	validationQuery="select 1 from sysibm.sysdummy1" validationInterval="30000"
	timeBetweenEvictionRunsMillis="30000" maxActive="300" maxIdle="30"
	maxWait="30000" initialSize="10" removeAbandonedTimeout="500"
	removeAbandoned="true" logAbandoned="true" minEvictableIdleTimeMillis="30000"
	jmxEnabled="true" username="***REMOVED***" password="***REMOVED***"
	driverClassName="com.ibm.as400.access.AS400JDBCDriver" url="***REMOVED***" />

<Resource name="jdbc/ORACLE_EAE" auth="Container" type="javax.sql.DataSource" 
	maxActive="100" maxIdle="30" minIdle="0" validationQuery="select 1 from dual" 
	maxWait="10000" initialSize="1" username="EAE" password="EAE" driverClassName="oracle.jdbc.driver.OracleDriver" 
	url="***REMOVED***" poolPreparedStatements="true" />
+------------------------------------------+	

** Tester si l'application fontionne correctement
